<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Inline.px - Ultra-Compact Pixel Art Editor</title>
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- Material Symbols Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- Pixelify Sans Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Left Toolbox -->
        <aside class="toolbox">
            <div class="toolbox-header">
                <h2>Tools</h2>
            </div>
            <div class="toolbox-content" id="toolbox">
                <!-- Tools generated dynamically -->
            </div>
        </aside>

        <!-- Center Canvas Area -->
        <main class="workspace">
            <!-- Top Menu Bar -->
            <div class="menu-bar">
                <div class="menu-section">
                    <button id="newBtn" class="menu-btn" title="New (Ctrl+N)">
                        <span class="material-symbols-outlined">description</span> New
                    </button>
                    <button id="saveBtn" class="menu-btn" title="Save (Ctrl+S)">
                        <span class="material-symbols-outlined">save</span> Save
                    </button>
                    <button id="loadBtn" class="menu-btn" title="Load (Ctrl+O)">
                        <span class="material-symbols-outlined">folder_open</span> Load
                    </button>
                </div>
                <div class="menu-section">
                    <button id="undoBtn" class="menu-btn" title="Undo (Ctrl+Z)" disabled>
                        <span class="material-symbols-outlined">undo</span> Undo
                    </button>
                    <button id="redoBtn" class="menu-btn" title="Redo (Ctrl+Y)" disabled>
                        <span class="material-symbols-outlined">redo</span> Redo
                    </button>
                </div>
                <div class="menu-section">
                    <button id="exportFileBtn" class="menu-btn" title="Export">
                        <span class="material-symbols-outlined">download</span> Export
                    </button>
                    <button id="importStringBtn" class="menu-btn" title="Import">
                        <span class="material-symbols-outlined">upload</span> Import
                    </button>
                </div>
                <div class="menu-section">
                    <button id="clearBtn" class="menu-btn menu-btn-danger" title="Clear">
                        <span class="material-symbols-outlined">delete</span> Clear
                    </button>
                </div>
            </div>

            <!-- Canvas Info Bar with Tool Options -->
            <div class="info-bar">
                <div class="info-group">
                    <span class="info-label">Tool:</span>
                    <span id="currentToolName" class="info-value">Brush</span>
                </div>

                <!-- Tool Options (shown dynamically) -->
                <div class="info-group" id="brushSizeOption" style="display: none;">
                    <span class="info-label">Size:</span>
                    <div class="tool-size-buttons">
                        <button class="tool-size-btn active" data-size="1">1</button>
                        <button class="tool-size-btn" data-size="2">2</button>
                        <button class="tool-size-btn" data-size="3">3</button>
                        <button class="tool-size-btn" data-size="5">5</button>
                    </div>
                </div>

                <div class="info-group" id="shapeModeOption" style="display: none;">
                    <span class="info-label">Mode:</span>
                    <div class="tool-mode-buttons">
                        <button class="tool-mode-btn active" data-mode="fill">Fill</button>
                        <button class="tool-mode-btn" data-mode="stroke">Stroke</button>
                    </div>
                </div>

                <div class="info-spacer"></div>

                <div class="info-group">
                    <span class="info-label">Size:</span>
                    <span id="canvasSizeDisplay" class="info-value">16×16</span>
                </div>
                <div class="info-group">
                    <span class="info-label">Color:</span>
                    <div id="currentColorDisplay" class="color-indicator"></div>
                    <span id="currentColorCode" class="info-value">1</span>
                </div>
            </div>

            <!-- Welcome Screen (shown on startup) -->
            <div id="welcomeScreen" class="welcome-screen">
                <div class="welcome-content">
                    <div class="welcome-header">
                        <h1 class="welcome-title">Inline.px</h1>
                        <p class="welcome-subtitle">Ultra-Compact Pixel Art Editor</p>
                    </div>

                    <div class="welcome-actions">
                        <div class="welcome-section">
                            <button id="welcomeNewBtn" class="welcome-btn welcome-btn-primary">
                                <span class="material-symbols-outlined welcome-btn-icon">add_circle</span>
                                <span class="welcome-btn-label">Create New</span>
                                <span class="welcome-btn-desc">Start with a blank canvas</span>
                            </button>
                        </div>

                        <div class="welcome-divider">
                            <span>or</span>
                        </div>

                        <div class="welcome-section">
                            <button id="welcomeLoadBtn" class="welcome-btn welcome-btn-secondary">
                                <span class="material-symbols-outlined welcome-btn-icon">folder_open</span>
                                <span class="welcome-btn-label">Open File</span>
                                <span class="welcome-btn-desc">Load from saved files</span>
                            </button>
                        </div>
                    </div>

                    <div class="welcome-recent" id="welcomeRecentFiles" style="display: none;">
                        <h3 class="welcome-recent-title">Recent Files</h3>
                        <div class="welcome-recent-list" id="welcomeRecentList">
                            <!-- Recent files populated dynamically -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Canvas Container -->
            <div class="canvas-container" id="canvasContainer" style="display: none;">
                <div class="canvas-wrapper">
                    <canvas id="pixelCanvas"></canvas>
                </div>
            </div>

            <!-- Live Export Preview -->
            <div class="export-panel">
                <div class="export-panel-header">
                    <h3>Export String</h3>
                    <button id="copyLiveStringBtn" class="icon-btn" title="Copy">
                        <span class="material-symbols-outlined">content_copy</span>
                    </button>
                </div>
                <div class="export-content">
                    <code id="liveExportString" class="export-code">16x16:0000...</code>
                </div>
                <div class="export-info">
                    <span><strong>Format:</strong> Base64 (64 colors)</span>
                    <span><strong>Length:</strong> <span id="stringLength">0</span> chars</span>
                </div>
            </div>
        </main>

        <!-- Right Properties Panel -->
        <aside class="properties-panel">
            <!-- Canvas Size -->
            <div class="panel-section">
                <h3 class="panel-title">Canvas Size</h3>
                <div class="size-presets">
                    <button class="preset-btn active" data-size="8">8×8</button>
                    <button class="preset-btn" data-size="16">16×16</button>
                    <button class="preset-btn" data-size="32">32×32</button>
                    <button class="preset-btn" data-size="64">64×64</button>
                </div>
                <div class="custom-size">
                    <div class="size-input-row">
                        <input type="number" id="canvasWidth" min="2" max="128" value="8" placeholder="W">
                        <span>×</span>
                        <input type="number" id="canvasHeight" min="2" max="128" value="8" placeholder="H">
                    </div>
                    <button id="resizeBtn" class="btn-primary">Apply</button>
                </div>
            </div>

            <!-- Color Palette -->
            <div class="panel-section">
                <h3 class="panel-title">Color Palette</h3>
                <div id="colorPalette" class="color-grid">
                    <!-- Generated dynamically -->
                </div>
            </div>
        </aside>
    </div>

    <!-- Import Modal -->
    <div class="modal" id="importModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Import from String</h2>
                <button id="closeImportModal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Paste your Base64 pixel art string (format: WxH:DATA)</p>
                <textarea id="importTextarea" rows="8" placeholder="16x16:123ABC..."></textarea>
            </div>
            <div class="modal-footer">
                <button id="cancelImportBtn" class="btn-secondary">Cancel</button>
                <button id="confirmImportBtn" class="btn-primary">Import</button>
            </div>
        </div>
    </div>

    <!-- New File Modal -->
    <div class="modal" id="newFileModal" style="display: none;">
        <div class="modal-content modal-content-large">
            <div class="modal-header">
                <h2>Create New File</h2>
                <button id="closeNewFileModal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="new-file-form">
                    <div class="form-group">
                        <label for="newFileName">Name</label>
                        <input type="text" id="newFileName" placeholder="Untitled" class="form-input">
                    </div>

                    <div class="form-group">
                        <label>Canvas Size</label>
                        <div class="size-presets-modal">
                            <button class="preset-btn-modal active" data-size="8">8×8</button>
                            <button class="preset-btn-modal" data-size="16">16×16</button>
                            <button class="preset-btn-modal" data-size="32">32×32</button>
                            <button class="preset-btn-modal" data-size="64">64×64</button>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="newFileWidth">Width</label>
                            <input type="number" id="newFileWidth" min="2" max="128" value="8" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="newFileHeight">Height</label>
                            <input type="number" id="newFileHeight" min="2" max="128" value="8" class="form-input">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelNewFileBtn" class="btn-secondary">Cancel</button>
                <button id="confirmNewFileBtn" class="btn-primary">Create</button>
            </div>
        </div>
    </div>

    <!-- File Selection Modal -->
    <div class="modal" id="fileModal" style="display: none;">
        <div class="modal-content modal-content-large">
            <div class="modal-header">
                <h2>Open File</h2>
                <button id="closeModal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="fileList" class="file-grid"></div>
                <p id="noFilesMessage" style="display: none; text-align: center; color: #666; padding: 40px;">
                    No saved files found.
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application Entry Point (Bundled by Vite) -->
    <script type="module" src="/js/main.js"></script>
</body>
</html>
